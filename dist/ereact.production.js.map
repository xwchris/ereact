{"version":3,"sources":["webpack://EReact/webpack/universalModuleDefinition","webpack://EReact/webpack/bootstrap","webpack://EReact/./src/constants.js","webpack://EReact/./src/utils.js","webpack://EReact/./src/component.js","webpack://EReact/./src/render.js","webpack://EReact/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","INTERNAL_NODE","isArray","array","Array","toString","willRenderQueue","Component","props","context","this","_dirty","_renderCallbacks","assign","setState","state","callback","prevState","push","oldNode","dom","element","parentDom","parentNode","updateComponent","forceUpdate","render","renderMode","isReceiveProps","instance","setComponentProps","prevProps","prevContext","skipRender","shouldComponentUpdate","componentWillUpdate","getChildContext","childElement","oldChildNode","childNode","reconcile","map","componentDidUpdate","length","pop","func","Promise","resolve","then","setTimeout","defer","_willRenderQueue$pop","nextInstance","nextParentDom","nextOldNode","nextElement","nextContext","createComponent","Constructor","constructor","isUpdate","componentWillReceiveProps","componentWillMount","renderComponent","createNode","componentDidMount","createTextElement","text","type","nodeValue","isTextElement","buildComponent","document","createTextNode","createElement","childNodes","reconcileChildren","updateProperties","forEach","appendChild","node","flatten","reduce","flat","toFlatten","concat","removeChild","children","componentWillUnmount","replaceChild","oldChildNodes","childElements","Math","max","oldProps","setAccessor","undefined","console","error","_typeof","style","innerHTML","__html","startsWith","useCapture","endsWith","eventType","toLowerCase","substring","addEventListener","eventProxy","removeEventListener","_listener","setAttribute","e","__webpack_exports__","initProps","_ref","_len","arguments","args","_key","apply","filter","child","containerDom"],"mappings":"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","file":"ereact.production.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"EReact\"] = factory();\n\telse\n\t\troot[\"EReact\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/static\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","'use strict';\n\nconst TEXT_ELEMENT = `@ereact/__text_element__`;\n\nconst INTERNAL_NODE = '@ereact/__internal_node';\n\nconst ATTR_KEY = '@ereact/__attr_key__';\n\n// Render mode constants\nconst SYNC_RENDER = '@ereact/render_sync';\nconst ASYNC_RENDER = '@ereact/render_async';\nconst FORCE_RENDER = '@ereact/force_update';\n\nexport { ATTR_KEY, TEXT_ELEMENT, SYNC_RENDER, ASYNC_RENDER, FORCE_RENDER, INTERNAL_NODE };\n","export const isArray = array => typeof Array.isArray === 'function' ? Array.isArray(array) : Object.prototype.toString.call(array) === '[object Array]';\n\nexport const defer = func => typeof Promise === 'function' ? Promise.resolve().then(func) : setTimeout(func);\n\nexport const flatten = array => array.reduce((flat, toFlatten) => flat.concat(isArray(toFlatten) ? flatten(toFlatten) : toFlatten), []);\n","import { INTERNAL_NODE, FORCE_RENDER, ASYNC_RENDER, SYNC_RENDER } from './constants';\nimport { reconcile, createNode } from './render';\nimport { isArray, defer } from './utils';\n\nconst willRenderQueue = [];\n\nfunction Component (props, context) {\n  this._dirty = false;\n\n  this.props = props || {};\n  this.context = context || {};\n\n  this._renderCallbacks = []\n}\n\nObject.assign(Component.prototype, {\n  setState(state, callback) {\n    if (!this.prevState) {\n      this.prevState = this.state;\n    }\n    this.state = Object.assign({}, this.state, state);\n    if (typeof callback === 'function') {\n      this._renderCallbacks.push(callback);\n    }\n\n    const oldNode = this[INTERNAL_NODE];\n    const { dom, element } = oldNode;\n    const parentDom = isArray(dom) ? dom[0].parentNode : dom.parentNode;\n\n    updateComponent(ASYNC_RENDER, parentDom, oldNode, element);\n  },\n\n  forceUpdate(callback) {\n    if (typeof callback === 'function') {\n      this._renderCallbacks.push(callback);\n    }\n\n    const oldNode = this[INTERNAL_NODE];\n    const { dom, element } = oldNode;\n    const parentDom = isArray(dom) ? dom[0].parentNode : dom.parentNode;\n    updateComponent(FORCE_RENDER, parentDom, oldNode, element);\n  },\n\n  render() {}\n});\n\nconst buildComponent = (element, context) => {\n  const { type, props } = element;\n  let instance = null;\n\n  instance = createComponent(type, props, context);\n  setComponentProps(instance, props);\n\n  instance[INTERNAL_NODE] = instance[INTERNAL_NODE] || { element };\n  renderComponent(instance, context)\n\n  return instance[INTERNAL_NODE];\n}\n\nconst updateComponent = (renderMode, parentDom, oldNode, element, context, isReceiveProps) => {\n  const instance = oldNode.instance;\n  if (isReceiveProps) {\n    setComponentProps(instance, element.props);\n  }\n\n  const props = instance.props;\n  const state = instance.state;\n  const prevProps = instance.prevProps || props;\n  const prevState = instance.prevState || state;\n  const prevContext = instance.prevContext || context;\n  let skipRender = false;\n\n  if (renderMode === ASYNC_RENDER) {\n    if (!instance._dirty && willRenderQueue.push({ instance, parentDom, oldNode, element, context }) === 1) {\n      // only first time\n      instance._dirty = true;\n\n      defer(() => {\n        const {\n          instance: nextInstance,\n          parentDom: nextParentDom,\n          oldNode: nextOldNode,\n          element: nextElement,\n          context: nextContext,\n        } = willRenderQueue.pop();\n\n        if (nextInstance._dirty) {\n          updateComponent(SYNC_RENDER, nextParentDom, nextOldNode, nextElement, nextContext);\n        }\n      });\n    }\n    return;\n  }\n\n  instance._dirty = false;\n\n  instance.props = prevProps;\n  instance.state = prevState;\n  instance.context = prevContext;\n\n  if (renderMode !== FORCE_RENDER && typeof instance.shouldComponentUpdate === 'function' && instance.shouldComponentUpdate(props, state) === false) {\n    skipRender = true;\n  } else if (typeof instance.componentWillUpdate === 'function') {\n    instance.componentWillUpdate(props, state);\n  }\n\n  instance.props = props;\n  instance.state = state;\n  instance.context = context;\n\n  instance.prevProps = instance.prevState = instance.prevContext = null;\n\n  if (!skipRender) {\n\n    if (typeof instance.getChildContext === 'function') {\n      context = Object.assign({}, context, instance.getChildContext());\n    }\n\n    const childElement = instance.render();\n    const oldChildNode = oldNode.childNode;\n\n    const childNode = reconcile(parentDom, oldChildNode, childElement, context);\n\n    const dom = isArray(childNode) ? childNode.map(n => n.dom) : childNode.dom;\n\n    Object.assign(oldNode, { dom, childNode, element });\n\n    if (typeof instance.componentDidUpdate === 'function') {\n      instance.componentDidUpdate(prevProps, prevState);\n    }\n\n    while (instance._renderCallbacks.length) {\n      instance._renderCallbacks.pop().call(instance);\n    }\n  }\n\n  return oldNode;\n}\n\nconst createComponent = (Constructor, props, context) => {\n  let instance;\n  if (!(Constructor.prototype && Constructor.prototype.render)) {\n    const render = Constructor;\n    Constructor = function (props, context) {\n      Component.prototype.constructor.bind(this, props, context);\n    }\n    Constructor.prototype = Component.prototype;\n    Constructor.prototype.render = function() {\n      return render(this.props);\n    }\n  }\n\n  instance = new Constructor(props, context);\n  Component.call(instance, props, context);\n\n  instance.constructor = Constructor;\n  return instance;\n}\n\nconst setComponentProps = (instance, props) => {\n  const isUpdate = !!instance[INTERNAL_NODE];\n  if (isUpdate && typeof instance.componentWillReceiveProps === 'function') {\n    instance.componentWillReceiveProps(props);\n  } else if (!isUpdate && typeof instance.componentWillMount === 'function'){\n    instance.componentWillMount();\n  }\n\n  if (!instance.prevProps) instance.prevProps = instance.props;\n  if (!instance.prevContext) instance.prevContext = instance.context;\n\n  instance.props = props;\n}\n\nconst renderComponent = (instance, context) => {\n  instance.prevProps = instance.prevState = instance.prevContext = null;\n\n  if (typeof instance.getChildContext === 'function') {\n    context = Object.assign({}, context, instance.getChildContext());\n  }\n\n  const childElement = instance.render();\n\n  let childNode = null;\n  let dom = null;\n  if (isArray(childElement)) {\n    childNode = childElement.map(element => createNode(element, context))\n    dom = childNode.map(n => n.dom);\n  } else {\n    childNode = createNode(childElement, context);\n    dom = childNode.dom;\n  }\n  Object.assign(instance[INTERNAL_NODE], { dom, childNode, instance });\n\n  if (typeof instance.componentDidMount === 'function') {\n    instance.componentDidMount();\n  }\n\n  while (instance._renderCallbacks.length) {\n    instance._renderCallbacks.pop().call(instance);\n  }\n}\n\nexport { Component, buildComponent, updateComponent };\n","import { TEXT_ELEMENT, SYNC_RENDER } from './constants';\nimport { buildComponent, updateComponent } from './component';\nimport { isArray, flatten } from './utils';\n\n// render\nconst render = (element, containerDom) => {\n  reconcile(containerDom, null, element, {});\n}\n\n// createElement\nconst createElement = (type, initProps, ...args) => {\n  const props = Object.assign({}, initProps);\n  const rawChildren = [].concat(...args);\n  const children = rawChildren\n    .filter(child => child != null && typeof child !== 'boolean')\n    .map(child => child instanceof Object ? child : createTextElement(child));\n\n  props.children = children;\n  return { type, props, children };\n}\n\nconst createTextElement = text => {\n  return {\n    type: TEXT_ELEMENT,\n    props: { nodeValue: text },\n  }\n}\n\nconst createNode = (element, context) => {\n  const { type, props } = element;\n  const isTextElement = type === TEXT_ELEMENT;\n  const isComponent = typeof type === 'function';\n\n  if (isComponent) {\n    return buildComponent(element, context);\n  }\n\n  const dom = isTextElement ? document.createTextNode('') : document.createElement(type);\n  const childNodes = reconcileChildren({ dom }, element, context);\n  updateProperties(dom, {}, props);\n\n  return { dom, element, childNodes };\n}\n\nconst reconcile = (parentDom, oldNode, element, context) => {\n  if (oldNode == null) {\n    if (isArray(element)) {\n      const node = element.map(createNode);\n      node.forEach(n => {\n        parentDom.appendChild(n.dom);\n      })\n    }\n\n    const node = createNode(element, context);\n\n    if (isArray(node.dom)) {\n      const doms = flatten(node.dom);\n      doms.forEach(dom => parentDom.appendChild(dom));\n    } else if (node.dom) {\n      parentDom.appendChild(node.dom);\n    }\n    return node;\n  } else if (element == null) {\n    if (isArray(oldNode)) {\n      oldNode.forEach(n => {\n        parentDom.removeChild(n.dom);\n      })\n    } else if (oldNode.dom) {\n      parentDom.removeChild(oldNode.dom);\n    }\n    return null;\n  } else if (isArray(oldNode) && isArray(element)) {\n    return reconcileChildren({ dom: parentDom, childNodes: oldNode }, { props: { children: element } }, context);\n  } else if ((oldNode.element || {}).type !== element.type) {\n    const node = createNode(element, context);\n\n    if (oldNode.element && typeof oldNode.element.type === 'function' && typeof oldNode.instance.componentWillUnmount === 'function') {\n      oldNode.instance.componentWillUnmount();\n    }\n\n    if (oldNode.dom || oldNode[0].dom) {\n      parentDom.replaceChild(node.dom, oldNode.dom || oldNode[0].dom);\n    }\n    return node;\n  } else if (typeof element.type === 'string') {\n    oldNode.childNodes = reconcileChildren(oldNode, element, context);\n    updateProperties(oldNode.dom, oldNode.element.props, element.props);\n    oldNode.element = element;\n    return oldNode;\n  } else {\n    return updateComponent(SYNC_RENDER, parentDom, oldNode, element, context, true);\n  }\n}\n\nconst reconcileChildren = (oldNode, element, context) => {\n  const oldChildNodes = oldNode.childNodes || [];\n  const childElements = element.props.children || [];\n  const childNodes = [];\n  const length = Math.max(oldChildNodes.length, childElements.length);\n  for (let i = 0; i < length; i++) {\n    const childNode = reconcile(oldNode.dom, oldChildNodes[i], childElements[i], context);\n    childNodes.push(childNode);\n  }\n  return childNodes;\n}\n\nconst updateProperties = (dom, oldProps, props) => {\n  for (name in oldProps) {\n    if (props[name] == null) {\n      setAccessor(dom, name, undefined);\n    }\n  }\n\n  for (name in props) {\n    // fix: name === 'value' || name === 'checked' ? dom[name] : oldProps[name]\n    if (props[name] !== oldProps[name]) {\n      setAccessor(dom, name, props[name]);\n    }\n  }\n}\n\nconst setAccessor = (dom, name, value) => {\n  // className htmlFor\n  if (name === 'className') {\n    name = 'class';\n  }\n\n  if (name === 'htmlFor') {\n    name = 'for';\n  }\n\n  if (name === 'key' || name === 'children' || name === 'innerHTML') {\n    // ignore\n  } else if (name === 'nodeValue') {\n    dom.nodeValue = value;\n  } else if (name === 'ref' && value != null) {\n    if (typeof value === 'function') {\n      value(dom);\n    } else {\n      console.error('ref should be an function');\n    }\n  } else if (name === 'style') {\n    if (typeof value === 'object') {\n      for (let i in value) {\n        dom.style[i] = typeof value[i] === 'number' ? `${value[i]}px` : value[i];\n      }\n    }\n\n    if (typeof value === 'string' || value == null) {\n      dom.style = value;\n    }\n  } else if (name === 'dangerouslySetInnerHTML') {\n    if (typeof value === 'object') {\n      dom.innerHTML = value.__html;\n    }\n  } else if (name.startsWith('on')) {\n    const useCapture = name.endsWith('Capture');\n    const eventType = name.toLowerCase().substring(2);\n    if (value) {\n      dom.addEventListener(eventType, eventProxy, useCapture);\n    } else {\n      dom.removeEventListener(eventType, eventProxy, useCapture);\n    }\n    (dom._listener || (dom._listener = {}))[eventType] = value;\n  } else {\n    dom.setAttribute(name, value);\n  }\n}\n\nfunction eventProxy(e) {\n  return this._listener[e.type](e);\n}\n\nexport { createElement, render, reconcile, createNode, reconcileChildren };\n","import { render, createElement } from './render';\nimport { Component } from './component';\n\nexport default { createElement, render, Component };\n"],"sourceRoot":""}